* implement full energy calculation
* separate out GP solving from nonlinear-hamiltonian solving
